<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mortgage Calculator - Knoxville & Florida</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 20px;
        }
        .calculator-container {
            max-width: 1200px;
        }
        .result {
            display: none;
            padding: 15px;
        }
        .calculator-card {
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            background-color: #f8f9fa;
        }
        .form-label {
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }
        .form-control {
            font-size: 0.9rem;
            padding: 0.5rem;
        }
        .mb-3 {
            margin-bottom: 0.75rem !important;
        }
        h3 {
            font-size: 1.25rem;
        }
        .card-body {
            padding: 1rem;
        }
        .card-text {
            font-size: 0.85rem;
        }
        @media (max-width: 576px) {
            .calculator-card {
                padding: 10px;
            }
            .form-control {
                font-size: 0.8rem;
            }
            .form-label {
                font-size: 0.8rem;
            }
            h3 {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container calculator-container">
        <h2 class="mb-4 text-center">Mortgage Payment Calculators</h2>
        <div class="row">
            <!-- Knoxville Calculator -->
            <div class="col-6">
                <div class="calculator-card">
                    <h3 class="mb-3 text-center">Knoxville</h3>
                    <form id="knoxvilleForm">
                        <div class="mb-3">
                            <label for="knoxvilleHomePrice" class="form-label">Home Price ($)</label>
                            <input type="number" class="form-control" id="knoxvilleHomePrice" inputmode="numeric" value="450000" required>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvilleDownPayment" class="form-label">Down Payment ($)</label>
                            <input type="number" class="form-control" id="knoxvilleDownPayment" inputmode="numeric" value="150000" required>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvilleDownPaymentPercent" class="form-label">Down Payment (%)</label>
                            <input type="number" step="0.1" class="form-control" id="knoxvilleDownPaymentPercent" inputmode="decimal" value="33.33" required>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvilleInterestRate" class="form-label">Interest Rate (%)</label>
                            <input type="number" step="0.1" class="form-control" id="knoxvilleInterestRate" inputmode="decimal" value="6.8" required>
                            <small><a href="https://www.freddiemac.com/pmms" target="_blank">Compare rates</a></small>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvilleLoanTerm" class="form-label">Loan Term (years)</label>
                            <input type="number" class="form-control" id="knoxvilleLoanTerm" inputmode="numeric" value="30" required>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvillePropertyTaxes" class="form-label">Annual Property Taxes ($)</label>
                            <input type="number" class="form-control" id="knoxvillePropertyTaxes" inputmode="numeric" value="1500" required>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvilleInsurance" class="form-label">Annual Insurance ($)</label>
                            <input type="number" class="form-control" id="knoxvilleInsurance" inputmode="numeric" value="800" required>
                        </div>
                        <div class="mb-3">
                            <label for="knoxvilleHoa" class="form-label">Monthly HOA Fees ($)</label>
                            <input type="number" class="form-control" id="knoxvilleHoa" inputmode="numeric" value="35">
                        </div>
                        <div class="mb-3 text-center">
                            <button type="button" class="btn btn-secondary btn-sm" onclick="resetForm('knoxville')">Reset</button>
                        </div>
                    </form>
                    <div id="knoxvilleResult" class="mt-3 card result">
                        <div class="card-body">
                            <h3 class="card-title">Results:</h3>
                            <p class="card-text">Loan Amount: <span id="knoxvilleLoanAmount"></span></p>
                            <p class="card-text">Down Payment Percentage: <span id="knoxvilleDownPaymentPercentDisplay"></span></p>
                            <p class="card-text">Estimated Closing Costs (2%-5%): <span id="knoxvilleClosingCosts"></span></p>
                            <p class="card-text">Monthly Principal & Interest: <span id="knoxvilleMonthlyPI"></span></p>
                            <p class="card-text">Monthly Taxes: <span id="knoxvilleMonthlyTaxes"></span></p>
                            <p class="card-text">Monthly Insurance: <span id="knoxvilleMonthlyInsurance"></span></p>
                            <p class="card-text">Monthly HOA: <span id="knoxvilleMonthlyHOA"></span></p>
                            <p class="card-text"><strong>Total Monthly Payment: <span id="knoxvilleTotalPayment"></span></strong></p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Florida Calculator -->
            <div class="col-6">
                <div class="calculator-card">
                    <h3 class="mb-3 text-center">Florida</h3>
                    <form id="floridaForm">
                        <div class="mb-3">
                            <label for="floridaHomePrice" class="form-label">Home Price ($)</label>
                            <input type="number" class="form-control" id="floridaHomePrice" inputmode="numeric" value="450000" required>
                        </div>
                        <div class="mb-3">
                            <label for="floridaDownPayment" class="form-label">Down Payment ($)</label>
                            <input type="number" class="form-control" id="floridaDownPayment" inputmode="numeric" value="150000" required>
                        </div>
                        <div class="mb-3">
                            <label for="floridaDownPaymentPercent" class="form-label">Down Payment (%)</label>
                            <input type="number" step="0.1" class="form-control" id="floridaDownPaymentPercent" inputmode="decimal" value="33.33" required>
                        </div>
                        <div class="mb-3">
                            <label for="floridaInterestRate" class="form-label">Interest Rate (%)</label>
                            <input type="number" step="0.1" class="form-control" id="floridaInterestRate" inputmode="decimal" value="6.8" required>
                            <small><a href="https://www.freddiemac.com/pmms" target="_blank">Compare rates</a></small>
                        </div>
                        <div class="mb-3">
                            <label for="floridaLoanTerm" class="form-label">Loan Term (years)</label>
                            <input type="number" class="form-control" id="floridaLoanTerm" inputmode="numeric" value="30" required>
                        </div>
                        <div class="mb-3">
                            <label for="floridaPropertyTaxes" class="form-label">Annual Property Taxes ($)</label>
                            <input type="number" class="form-control" id="floridaPropertyTaxes" inputmode="numeric" value="6500" required>
                        </div>
                        <div class="mb-3">
                            <label for="floridaInsurance" class="form-label">Annual Insurance ($)</label>
                            <input type="number" class="form-control" id="floridaInsurance" inputmode="numeric" value="4000" required>
                        </div>
                        <div class="mb-3">
                            <label for="floridaHoa" class="form-label">Monthly HOA Fees ($)</label>
                            <input type="number" class="form-control" id="floridaHoa" inputmode="numeric" value="100">
                        </div>
                        <div class="mb-3 text-center">
                            <button type="button" class="btn btn-secondary btn-sm" onclick="resetForm('florida')">Reset</button>
                        </div>
                    </form>
                    <div id="floridaResult" class="mt-3 card result">
                        <div class="card-body">
                            <h3 class="card-title">Results:</h3>
                            <p class="card-text">Loan Amount: <span id="floridaLoanAmount"></span></p>
                            <p class="card-text">Down Payment Percentage: <span id="floridaDownPaymentPercentDisplay"></span></p>
                            <p class="card-text">Estimated Closing Costs (2%-5%): <span id="floridaClosingCosts"></span></p>
                            <p class="card-text">Monthly Principal & Interest: <span id="floridaMonthlyPI"></span></p>
                            <p class="card-text">Monthly Taxes: <span id="floridaMonthlyTaxes"></span></p>
                            <p class="card-text">Monthly Insurance: <span id="floridaMonthlyInsurance"></span></p>
                            <p class="card-text">Monthly HOA: <span id="floridaMonthlyHOA"></span></p>
                            <p class="card-text"><strong>Total Monthly Payment: <span id="floridaTotalPayment"></span></strong></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function calculateMortgage(prefix) {
            // Get input values
            const homePrice = parseFloat(document.getElementById(`${prefix}HomePrice`).value) || 0;
            let downPayment = parseFloat(document.getElementById(`${prefix}DownPayment`).value) || 0;
            let downPaymentPercent = parseFloat(document.getElementById(`${prefix}DownPaymentPercent`).value) || 0;
            const interestRate = parseFloat(document.getElementById(`${prefix}InterestRate`).value) / 100 / 12 || 0;
            const loanTerm = parseFloat(document.getElementById(`${prefix}LoanTerm`).value) * 12 || 0;
            const annualTaxes = parseFloat(document.getElementById(`${prefix}PropertyTaxes`).value) || 0;
            const annualInsurance = parseFloat(document.getElementById(`${prefix}Insurance`).value) || 0;
            const hoaInput = document.getElementById(`${prefix}Hoa`).value;
            const monthlyHOA = hoaInput === '' || isNaN(parseFloat(hoaInput)) ? 0 : parseFloat(hoaInput);

            // Validate critical inputs
            if (isNaN(homePrice) || homePrice <= 0 || isNaN(interestRate) || isNaN(loanTerm)) {
                document.getElementById(`${prefix}Result`).style.display = 'none';
                return;
            }

            // Sync down payment and percentage
            if (document.activeElement.id === `${prefix}DownPaymentPercent` && !isNaN(downPaymentPercent)) {
                // If percentage input is active, update down payment
                downPayment = (downPaymentPercent / 100) * homePrice;
                document.getElementById(`${prefix}DownPayment`).value = downPayment.toFixed(2);
            } else if (homePrice > 0) {
                // Otherwise, update percentage based on down payment
                downPaymentPercent = (downPayment / homePrice) * 100;
                document.getElementById(`${prefix}DownPaymentPercent`).value = downPaymentPercent.toFixed(2);
            }

            // Validate down payment
            if (downPayment >= homePrice || downPaymentPercent >= 100 || downPayment < 0) {
                document.getElementById(`${prefix}Result`).style.display = 'none';
                return;
            }

            // Calculate loan amount
            const loanAmount = homePrice - downPayment;

            // Calculate monthly principal and interest
            const monthlyPI = (loanAmount * interestRate * Math.pow(1 + interestRate, loanTerm)) / 
                            (Math.pow(1 + interestRate, loanTerm) - 1) || 0;

            // Calculate monthly taxes and insurance
            const monthlyTaxes = annualTaxes / 12;
            const monthlyInsurance = annualInsurance / 12;

            // Calculate closing costs (2% to 5% of home price)
            const closingCostsLow = homePrice * 0.02;
            const closingCostsHigh = homePrice * 0.05;

            // Calculate total monthly payment
            const totalPayment = monthlyPI + monthlyTaxes + monthlyInsurance + monthlyHOA;

            // Display results
            document.getElementById(`${prefix}LoanAmount`).textContent = '$' + loanAmount.toFixed(2);
            document.getElementById(`${prefix}DownPaymentPercentDisplay`).textContent = downPaymentPercent.toFixed(2) + '%';
            document.getElementById(`${prefix}ClosingCosts`).textContent = '$' + closingCostsLow.toFixed(2) + ' - $' + closingCostsHigh.toFixed(2);
            document.getElementById(`${prefix}MonthlyPI`).textContent = '$' + monthlyPI.toFixed(2);
            document.getElementById(`${prefix}MonthlyTaxes`).textContent = '$' + monthlyTaxes.toFixed(2);
            document.getElementById(`${prefix}MonthlyInsurance`).textContent = '$' + monthlyInsurance.toFixed(2);
            document.getElementById(`${prefix}MonthlyHOA`).textContent = '$' + monthlyHOA.toFixed(2);
            document.getElementById(`${prefix}TotalPayment`).textContent = '$' + totalPayment.toFixed(2);
            document.getElementById(`${prefix}Result`).style.display = 'block';
        }

        function resetForm(prefix) {
            document.getElementById(`${prefix}Form`).reset();
            // Restore default values
            if (prefix === 'knoxville') {
                document.getElementById('knoxvilleHomePrice').value = '450000';
                document.getElementById('knoxvilleDownPayment').value = '150000';
                document.getElementById('knoxvilleDownPaymentPercent').value = '33.33';
                document.getElementById('knoxvilleInterestRate').value = '6.8';
                document.getElementById('knoxvilleLoanTerm').value = '30';
                document.getElementById('knoxvillePropertyTaxes').value = '1500';
                document.getElementById('knoxvilleInsurance').value = '800';
                document.getElementById('knoxvilleHoa').value = '35';
            } else if (prefix === 'florida') {
                document.getElementById('floridaHomePrice').value = '450000';
                document.getElementById('floridaDownPayment').value = '150000';
                document.getElementById('floridaDownPaymentPercent').value = '33.33';
                document.getElementById('floridaInterestRate').value = '6.8';
                document.getElementById('floridaLoanTerm').value = '30';
                document.getElementById('floridaPropertyTaxes').value = '6500';
                document.getElementById('floridaInsurance').value = '4000';
                document.getElementById('floridaHoa').value = '100';
            }
            document.getElementById(`${prefix}Result`).style.display = 'none';
            calculateMortgage(prefix); // Recalculate with default values
        }

        // Add event listeners to all inputs for real-time updates and zoom reset
        ['knoxville', 'florida'].forEach(prefix => {
            const inputs = document.querySelectorAll(`#${prefix}Form input`);
            inputs.forEach(input => {
                input.addEventListener('input', () => calculateMortgage(prefix));
                input.addEventListener('blur', () => {
                    // Reset viewport scale to 1.0 after input loses focus
                    document.querySelector('meta[name=viewport]').setAttribute('content', 
                        'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
                });
            });
            // Initial calculation with default values
            calculateMortgage(prefix);
        });
    </script>
</body>
</html>
